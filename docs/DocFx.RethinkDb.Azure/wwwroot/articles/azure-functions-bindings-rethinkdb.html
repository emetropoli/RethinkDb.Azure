<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>RethinkDB bindings for Azure Functions | RethinkDb.Azure </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="RethinkDB bindings for Azure Functions | RethinkDb.Azure ">
    <meta name="generator" content="docfx 2.40.1.0">
    
    <link rel="shortcut icon" href="../resources/ico/favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../resources/svg/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-12">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="rethinkdb-bindings-for-azure-functions">RethinkDB bindings for Azure Functions</h1>

<p>The RethinkDB bindings for Azure Functions supports trigger, input, and output bindings.</p>
<h2 id="packages">Packages</h2>
<p>The RethinkDB bindings for Azure Functions are provided in the <a href="http://www.nuget.org/packages/RethinkDb.Azure.WebJobs.Extensions">RethinkDb.Azure.WebJobs.Extensions</a> NuGet package.</p>
<pre><code>PM&gt;  Install-Package RethinkDb.Azure.WebJobs.Extensions
</code></pre><h2 id="trigger">Trigger</h2>
<p>The RethinkDB Trigger uses the <a href="https://rethinkdb.com/docs/changefeeds/">RethinkDB Changefeeds</a> to listen for inserts, updates and deletes.</p>
<h3 id="trigger---language-specific-examples">Trigger - language-specific examples</h3>
<h4 id="trigger---c-example">Trigger - C# example</h4>
<p>In <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-dotnet-class-library">C# class libraries</a>, use the <a href="../api/Microsoft.Azure.WebJobs.RethinkDbTriggerAttribute.html"><code>RethinkDbTrigger</code></a> attribute.</p>
<p>The attribute&#39;s constructor takes the database name and table name. For information about those settings and other properties that you can configure, see <a href="#trigger---configuration">Trigger - configuration</a>.</p>
<p>The following example shows a <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-dotnet-class-library">C# function</a> that is invoked when there are inserts, updates or deletes in the specified database and table.</p>
<pre><code class="lang-cs">using Microsoft.Extensions.Logging;
using RethinkDb.Azure.WebJobs.Extensions.Model;
using Demo.RethinkDb.Azure.Functions.Model;

namespace Demo.RethinkDb.Azure.Functions
{
    public static class RethinkDbTriggeredFunction
    {
        [FunctionName(&quot;RethinkDbTriggeredFunction&quot;)]
        public static void Run([RethinkDbTrigger(
            databaseName: &quot;ThreadStatsDb&quot;,
            tableName: &quot;ThreadStats&quot;,
            HostnameSetting = &quot;RethinkDbHostname&quot;)]DocumentChange change,
            ILogger log)
        {
            log.LogInformation(Document modified: &quot; + change.GetNewValue());
        }

    }
}
</code></pre><h3 id="trigger---configuration">Trigger - configuration</h3>
<p>The following table explains the binding configuration properties that you set in the <em>function.json</em> file and the <a href="../api/Microsoft.Azure.WebJobs.RethinkDbTriggerAttribute.html"><code>RethinkDbTrigger</code></a> attribute.</p>
<table>
<thead>
<tr>
<th>function.json property</th>
<th>Attribute property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>type</strong></td>
<td></td>
<td>Must be set to <code>rethinkDBTrigger</code>.</td>
</tr>
<tr>
<td><strong>direction</strong></td>
<td></td>
<td>Must be set to <code>in</code>. This parameter is set automatically when you create the trigger in the Azure portal.</td>
</tr>
<tr>
<td><strong>name</strong></td>
<td></td>
<td>The variable name used in function code that represents the changed document.</td>
</tr>
<tr>
<td><strong>hostnameSetting</strong></td>
<td><strong>HostnameSetting</strong></td>
<td>The name of an app setting that contains hostname or IP address of the RethinkDB server containing the database and table to monitor..</td>
</tr>
<tr>
<td><strong>databaseName</strong></td>
<td><strong>DatabaseName</strong></td>
<td>The name of the RethinkDB database with the table to monitor for changes.</td>
</tr>
<tr>
<td><strong>tableName</strong></td>
<td><strong>TableName</strong></td>
<td>The name of the table being monitored.</td>
</tr>
</tbody>
</table>
<h3 id="trigger---usage">Trigger - usage</h3>
<p>The trigger doesn&#39;t indicate directly whether a document was inserted, updated or deleted, it just provides the old and new value. In order to determine what was the operation one must base logic on old and new value presence/absence:</p>
<ul>
<li>If new value is present and old value absent, the operation was an insert.</li>
<li>If new value is absent and old value present, the operation was a delete.</li>
<li>If both values are present, the operation was an update.</li>
</ul>
</article>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Copyright © 2017 - 2018 Tomasz Pęczek
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
